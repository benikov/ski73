<script type="text/javascript"  src="static/js/manage-competitions.js"></script>
<h3>Загрузка результатов</h3>
<p>Форма загрузки позволяет выбрать xls файл, содеражщий результаты соревнования в соответствующем формате. Если файл составлен в соответсвии с требованиями, то информация будет занесена в базу данных с возможностью последующего их использования в системе.</p>

<form id="upload" action="handlexls" method="post" enctype="multipart/form-data">
  <b>Загрузка xls-файла</b><br>
  <input name="relatedxls" type="file"/><br>
  <input type="submit" value="Submit Comment" /> 
</form>

<style type="text/css">
    p {
	margin-top:10px;
	text-indent:10px;
    }
</style>

<h4>Инструкция по подготовке и загрузке протоколов соревнований на сайт</h4>

<p>Каждому соревнованию должен быть сопоставлен ровно один файл в формате xls. 
Раньше файлы должны были называться только английскими символами, но теперь эта бага исправлена (следует заметить, что лучше не использовать при именовании файлов кавычки - двойные и одинарные). Рекомендуемый формат именования файлов GG-MM-DD-Название.xls. Где GG - это год, MM - месяц, DD - день. Такое именование позволит ускорить визуальный поиск при размещении большого количества файлов в одной папке. Все файлы буду отсортированы в лексикографическом порядке.</p>

<p>Например: &nbsp&nbsp&nbsp&nbsp"12-02-25-III этап кубка области (на призы С. Бажанова).xls" или "12-12-25-1-ый этап кубка области - Гонка сильнейших 2011.xls"</p>

<p>Каждому забегу должен быть сопоставлен отдельный "лист". Именование листов может быть произвольным. Но лучше, чтобы оно соответствовало названию группы, которая бежит в данном забеге. На каждом листе должна быть размещена одна и только одна таблица посвященная ровно одному забегу. Однако, имели место случаи нарушения данной идеалогии, когда было необходимо на отдельном листе сформировать сводный результат по выступлению всех спортсменов во всех забегах (т. е. технически ничего не мешает размещать на листе данные не по конретному забегу). В результате разбора каждого листа в текущее соревнование будет помещены записи по забегам.</p>

<p>Итак, у администратора есть результаты соревнования. Он организует их в виде файла - электронной таблицы exel. Он знает, что участники соревнований были разделены на группы и у каждой группы имеется соответсвующее наименование - <b>имя группы</b>. Как правило, каждой группе соответствует определенная <b>соревновательная нагрузка</b>. <b>Таблица с результатами</b> для текущей группы.<p>

<p> Для наглядности, общая информация по всему соревнованию дублируется <b>без изменений</b> на каждом из листов. <b>Название соревнования</b>, <b>дата проведения</b>, <b>время начала</b>, <b> время окончания</b> соревнования, <b>главный судья</b>, <b>главный секретарь</b></p>

<p><b>Название соревнования</b> размещаетя на первых двух строчках каждого листа. <b>Таблица с результатами</b> забега содержит <b>n</b> колонок, заголовки которых должны быть уникальны в контексте текущего забега. Ровно <b>n</b> ячейек 1 и 2 строчек по отдельности  нужно объеденить, для этого и в ms exel и в open-office есть соответствующая кнопка на панели инструментов. Даже если <b>название</b> умещается в одну строчку - вторую нужно оставить пустой.</p>

<p>Ячейки третьей строчки объединяется подобно тому, как это было сделано для 1 и 2 строчек. В получившуюся в результате объединения ячейку помещается текстовое представление (формат ячеек->текст) даты в формате "19 февраля 2012 г." или же "19.02.2012" эти форматы считаются правильными. Результат разбора повлияет на ранжирование соревнования по времени.</p>

<p>Далее четвертая строчка условно делиться пополам, ячейки этих частей сливаются. В левую половину вписывается <b>имя текущей группы</b>, во вторую - <b> время начала</b> соревнования. Например: "Мужчины" и "Начало 11 ч 00 м".</p>

<p>Пятая строчка на каждом из листов состоит из двух частей, так же как и четвертая. В левую часть вносится <b>соревновательная нагрузка</b>, в правую <b> время окончания </b> соревнования. Например: "10 км - классический стиль" и "Окончание 13 ч 30 м"</p>

<p>Далее, на шестой строчке размещается <b>n</b> заголовков таблички с результатами для текущей <b>группы</b>. Все заголовки в рамках текущей таблицы не должны повторять друг друга.
Есть несколько рекомендаций по именованию отдельных заголовков:
</p>

<p>В заголовке столбца с Фамилией спортсменов должно помещаться значение "Фамилия И. О.", содержимое этого столбца предпочтительно должно заполняться фамилиями спортсменов в таком же формате. Например, "Рожков Д. С.", "Петров И. Д.", "Соколова В. И.". Несоблюдение этих рекомендаций сделает невозможным дальнейший анализ результатов спортсменов, набор и отображение статистики. По этим же соображениям лучше всегда в одном стиле именовать заголовки для места - <b>"м"</b>, результата - <b>"результат"</b>.</p>

<p>
  Результат подсчитывается как разность финишного и стартового времени спортсмена. Спортсмен с минимальным результатом по времени считается <b>лидером</b>. Далее, проигрыш для каждого спортсмена высчитывается по следующей формуле.
  <br><b style="margin-left:35%"><span class="brown">Результат спорсмена</span> - <span class="blue">результат лидера</span> = <span class="green">проигрыш</span></b>
  <br> Для применения формулы ко всем спортсменам - строим её только для лидера и протаскиваем по всем позициям. Для того чтобы результат лидера оставался неизменным для всех строчек в процессе протаскивания, перед номером строки лидера ставим знак доллара. (см. картинку) Форматы всех ячеек учавствующих в расчетах должны поддерживать вычисления по времени - это или особый формат или формат времени.
</p>

<div style="width:100%;text-align:center;margin-top:20px;margin-bottom:20px;">
  <img src="static/img/parse-comp-example2.png"/>
  <br>
  <b>Пример структуры расчета проигрыша по результатам соревнования для одного из забегов</b>
</div>


<p>За строчкой заголовков следует произвольное количество строк с содержимым таблицы результатов. Наличие пустых строчек за результатами нежелательно. Вся таблица с результатами обрамляется рамкой - но это дело эстетики.
Далее, после результатов на двух следующих строчках в 1-х ячейках располагаются главный судья и главный секретарь соревнований. Формат произвольный. В настоящий момент эта информация в систему не заносится.
</p>

<div style="width:100%;text-align:center;margin-top:20px;margin-bottom:20px;">
  <img src="static/img/parse-comp-example.png"/>
  <br>
  <b>Пример структуры размещения данных на листе одного из забегов соревнования "Чемпионат и Первенство Ульяновской области по лыжным гонкам. 2-ой этап кубка области"</b>
</div>

<p>Еще раз пробежимся по требованиям:
  <div style="margin-left:30px">
  <li>Xls-файл. Имя без кавычек. Начинается с даты в формате GG-MM-DD</li>
  <li>По одному листу на забег. Одна таблица на забег</li>
  <li>1-2 строки - нименование соревнования</li>
  <li>3 - дата проведения. "## месяц #### г." или "чч.мм.гггг" - формат ячейки текстовый</li>
  <li>4 - группа и время начала соревнования</li>
  <li>5 - соревновательная нагрузка и время окончания соревнования</li>
  <li>6 - заголовки. Все значения уникальны</li>
  <li>Сразу после таблицы с результатами следуют главный судья и главный секретарь</li>
  </div>
</p>

<p>Если Вы правите уже существующий протокол - сделанный кем-то ранее, то рекомендуется <br>
  1. Cначала выделить получившуюся в результате Ваших правок структуру. (мышью)<br>
  2. Вырезать её - поместит в буфер обмена. (<b>ctrl+x</b>)<br>
  3. Выделить все (<b>ctrl+a</b>) и удалить (все значения и форматирование) - это позволит защититься от случайных значений в случайных местах, которые могли остаться в наследство. <br>
  4. Вставить на место вашу структуру из буфера обмена (<b>ctrl+v</b>)<br>
  5. На выходе имеем стилистически грамотно оформленные результаты на чистом окружении
  6. Произвести эту операцию для каждого забега</p>
