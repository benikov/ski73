<script type="text/javascript"  src="static/js/manage-competitions.js"></script>
<h3>Загрузка результатов</h3>
<p>Форма загрузки позволяет выбрать xls файл, содеражщий результаты соревнования в соответствующем формате. Если файл составлен в соответсвии с требованиями, то информация будет занесена в базу данных с возможностью последующего их использования в системе.</p>

<form id="upload" action="handlexls" method="post" enctype="multipart/form-data">
  <b>Загрузка xls-файла</b><br>
  <input name="relatedxls" type="file"/><br>
  <input type="submit" value="Submit Comment" /> 
</form>

<style type="text/css">
    p {
	margin-top:10px;
	text-indent:10px;
    }
</style>

<h4>Инструкция по подготовке и загрузке протоколов соревнований на сайт</h4>

<p>Каждому соревнованию должен быть сопоставлен ровно один файл в формате xls. Поддерживаются как русские так и латинские имена файлов (кроме кавычек, двойных и одинарных). Рекомендуется называть файлы по формату GG-MM-DD-Название.xls. Например: <b>"12-02-25-III этап кубка области (на призы С. Бажанова).xls"</b> или <b>"12-12-25-1-ый этап кубка области - Гонка сильнейших 2011.xls"</b>  Где GG - это год, MM - месяц, DD - день. Это позволит сортировать файлы по имени с сохранением хронологии проведения соревнований.</p>

<p>Результаты организуются в виде некоторого числа забегов. Каждый забег представлен в виде отдельной таблицы, размещенной на отдельном листе. Как правило, в одном забеге учавтсвует отдельная возрастная группа спортсменов. <b>1 группа - 1 забег - 1 лист</b>. В результате разбора каждого листа формируется совокупность данных по сорвенованию в целом. Технически - ничто не мешает ввести в систему другие данные, главное - чтобы они соответствовали техническим требованиям. </p>

<p>Основаные понятия: <b>имя группы, соревновательная нагрузка, таблица с результатами</b> для текущей группы (забега). <b>Название соревнования</b>, <b>дата проведения</b>, <b>время начала</b>, <b> время окончания</b> соревнования, <b>главный судья</b>, <b>главный секретарь</b>.  Для наглядности, общая информация о соревнованиии соревнованию дублируется <b>без изменений</b> на каждом из листов. </p> 

<p><b>Название соревнования</b> размещаетя на первых двух строчках каждого листа. Сливаем ячейки этих строчек так, чтобы результирующие поля по ширине совпадали с размером таблицы с результатами. Если <b>название</b> умещается в одну строчку - вторую нужно оставить пустой.</p>

<p>В третью строчку помещается дата проведения соревнования в формате "19 февраля 2012 г". Результат разбора повлияет на ранжирование соревнования по времени.</p>

<p>Четвертая строчка условно делиться пополам, ячейки этих частей сливаются. В левую половину вписывается <b>имя текущей группы</b>, во вторую - <b> время начала</b> соревнования. Например: "Мужчины" и "Начало 11 ч 00 м".</p>

<p>То же в пятой строчек. В левую часть вносится <b>соревновательная нагрузка</b>, в правую <b> время окончания </b> соревнования. Например: "10 км - классический стиль" и "Окончание 13 ч 30 м"</p>

<div style="width:100%;text-align:center;margin-top:20px;margin-bottom:20px;">
  <img src="static/img/load-comp-guide/duplicate-competition-info.png" />
  <br>
  <b>Динамическое и статическое содержимое в заголовке листа</b>
</div>

<p>Далее, на шестой строчке размещается <b>n</b> заголовков таблички с результатами для текущей <b>группы</b>. Все заголовки в рамках текущей таблицы <b>не должны повторять друг друга</b>.
Есть несколько рекомендаций по именованию отдельных заголовков:
</p>

<p>В заголовке столбца с Фамилиями спортсменов должно помещаться значение "Фамилия И. О.", содержимое этого столбца предпочтительно должно заполняться фамилиями спортсменов в таком же формате. Например, "Рожков Д. С.", "Петров И. Д.", "Соколова В. И.". Место - <b>"м"</b>, результат - <b>"Результат"</b>. Несоблюдение этих рекомендаций сделает невозможным дальнейший анализ результатов спортсменов, набор и отображение статистики.</p>

<div style="width:100%;text-align:center;margin-top:20px;margin-bottom:20px;">
  <img src="static/img/load-comp-guide/caps.png" style="width:800px"/>
  <br>
  <b>Заголовки</b>
</div>

<p>За строчкой заголовков следует произвольное количество строк с содержимым таблицы результатов. Наличие пустых строчек за результатами нежелательно. Вся таблица с результатами обрамляется рамкой - но это дело эстетики.
После результатов на двух следующих строчках в 1-м столбце располагаются главный судья и главный секретарь соревнований. Формат произвольный. В настоящий момент эта информация в систему не заносится.
</p>

<div style="width:100%;text-align:center;margin-top:20px;margin-bottom:20px;">
  <img src="static/img/load-comp-guide/parse-comp-example.png"/>
  <br>
  <b>Пример структуры размещения данных на листе одного из забегов соревнования "Чемпионат и Первенство Ульяновской области по лыжным гонкам. 2-ой этап кубка области"</b>
</div>

<p>Еще раз пробежимся по требованиям:
  <div style="margin-left:30px">
  <li>Xls-файл. Имя без кавычек. Начинается с даты в формате GG-MM-DD</li>
  <li>По одному листу на забег. Одна таблица на забег</li>
  <li>1-2 строки - нименование соревнования</li>
  <li>3 - дата проведения. "## месяц #### г." или "чч.мм.гггг" - формат ячейки текстовый</li>
  <li>4 - группа и время начала соревнования</li>
  <li>5 - соревновательная нагрузка и время окончания соревнования</li>
  <li>6 - заголовки. Все значения уникальны</li>
  <li>Сразу после таблицы с результатами следуют главный судья и главный секретарь</li>
  </div>
</p>

<p>Если Вы правите уже существующий протокол - сделанный кем-то ранее, то рекомендуется <br>
  1. Cначала выделить получившуюся в результате Ваших правок структуру. (мышью)<br>
  2. Вырезать её - поместит в буфер обмена. (<b>ctrl+x</b>)<br>
  3. Выделить все (<b>ctrl+a</b>) и удалить (все значения и форматирование) - это позволит защититься от случайных значений в случайных местах, которые могли остаться в наследство. <br>
  4. Вставить на место вашу структуру из буфера обмена (<b>ctrl+v</b>)<br>
  5. На выходе имеем стилистически грамотно оформленные результаты на чистом окружении
  6. Произвести эту операцию для каждого забега</p>

<div style="width:100%;text-align:center;margin-top:20px;margin-bottom:20px;">
<iframe width="560" height="315" src="http://www.youtube.com/embed/TANkfr0MBcw" frameborder="0" allowfullscreen></iframe>
  <br>
  <b>Пример обработки файла с результатами соревнования</b>
</div>
